function [D,H,x,dx] = D1_6th(N, L)

dx = L/(N-1);
x = linspace(0,L,N)';

if N<12
    disp('Too few grid points'); return
end
Pinv=[43200/13649 8640/12013 4320/2711 4320/5359 8640/7877 43200/43801 ...
    ones(1,N-12) ...
    43200/43801 8640/7877 4320/5359 4320/2711 8640/12013 43200/13649] / dx;
diagQ=ones(N,1)*[-1 9 -45 0 45 -9 1]/60;
Q=spdiags(diagQ,-3:3,N,N);

Q(1,1) = -1/2;
Q(1,2) =  104009/172800;
Q(1,3) =  30443/259200;
Q(1,4) = -33311/86400;
Q(1,5) =  16863/86400;
Q(1,6) = -15025/518400;

Q(2,1) = -104009/172800;
Q(2,2) =  0;
Q(2,3) = -311/51840;
Q(2,4) =  20229/17280;
Q(2,5) = -24337/34560;
Q(2,6) =  36661/259200;

Q(3,1) = -30443/259200;
Q(3,2) =  311/51840;
Q(3,3) =  0;
Q(3,4) = -11155/25920;
Q(3,5) =  41287/51840;
Q(3,6) = -21999/86400;

Q(4,1) =  33311/86400;
Q(4,2) = -20229/17280;
Q(4,3) =  11155/25920;
Q(4,4) =  0;
Q(4,5) =  4147/17280;
Q(4,6) =  25427/259200;

Q(5,1) = -16863/86400;
Q(5,2) =  24337/34560;
Q(5,3) = -41287/51840;
Q(5,4) = -4147/17280;
Q(5,5) =  0;
Q(5,6) =  342523/518400;

Q(6,1) =  15025/518400;
Q(6,2) = -36661/259200;
Q(6,3) =  21999/86400;
Q(6,4) = -25427/259200;
Q(6,5) = -342523/518400;
Q(6,6) =  0;

Q(N-5:N,N-5:N) = -rot90(Q(1:6,1:6),2);

H = spdiags((1./Pinv).',0,N,N);
D = spdiags(Pinv.',0,N,N) * Q;
